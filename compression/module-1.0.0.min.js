/*! gruntest 2014-06-18 */
!function(a){var b={};b.info="VERSION: 1.0.0 \n AUTHOR: liuping \n A Controller For Modules";var c={executedList:{}},d={initFnName:"init",destroyFnName:"destroy",autoLoad:!0,sourceRoot:""},e={priorityQueue:{list:[],cbks:{}},historyQueue:[],busyState:{},globalLock:!1,addQueue:function(a,b){var c=f.parseObj({power:0,callBack:function(){}},b||{},!0);e.busyState[a]=!0,e.priorityQueue.list.splice(c.power,0,a),e.priorityQueue.cbks[a]||(e.priorityQueue.cbks[a]=[]),e.priorityQueue.cbks[a].push(c.callBack)},jsTagCreat:function(a){e.globalLock=!0;for(var b=f.parseObj({isAsyn:!0,isClear:!0},a||{});e.priorityQueue.list.length>0;){var c=e.priorityQueue.list.pop(),g=e.priorityQueue.cbks[c],h=document.createElement("script");h.type="text/javascript",h.defer=b.isAsyn,h.src=d.sourceRoot+c,b.isAsyn&&("onreadystatechange"in h?h.onreadystatechange=function(){var a=h.readyState;if("loaded"==a.toLowerCase()||"complete"==a.toLowerCase()){for(var d=0,i=g.length;i>d;d++)g[d](c);delete e.priorityQueue.cbks[c],e.busyState[c]=!1,b.isClear&&f.removeNode(h),e.historyQueue.push(c)}}:h.onload=function(){for(var a=0,d=g.length;d>a;a++)g[a](c);delete e.priorityQueue.cbks[c],e.busyState[c]=!1,b.isClear&&f.removeNode(h),e.historyQueue.push(c)}),document.body.appendChild(h)}0==e.priorityQueue.list.length&&(e.globalLock=!1)},loader:function(a,b){if(!f.isArray(a)){var a=f.trim(a),c=f.parseObj({isAsyn:!0,power:0,isClear:!0,callBack:function(){}},b||{},!0);return-1!=f.indexOf(a,e.historyQueue)?void c.callBack(a):void(e.priorityQueue.cbks[a]?e.addQueue(a,c):(e.addQueue(a,c),e.globalLock||e.jsTagCreat(c)))}for(var d=0;d<a.length;d++)e.loader(a[d],b)}},f=a.basetools,g=function(){var a={},b={};this.push=function(c,d,e){var g="";if(d.constructor==h)g=d.mName||f.unikey();else{if("string"!=typeof d)throw"MSG pushing error!";g=d}var i="__MSG__"+g,j=e.mName,k={data:c,sender:j,receiver:g},l=b[i]?b[i].length:0;if(!l)return a[i]?a[i].push(k):a[i]=[k],i;for(var m=0;l>m;m++){var n=b[i][m];n&&n(k)}},this.get=function(b){var c="";if(b.constructor==h)c=b.mName;else{if("string"!=typeof b)throw"MSG getting error!";c=b}if(c){var d="__MSG__"+c,e=a[d];return a[d]=[],e&&e.length?e:void 0}},this.addHandler=function(a,c){var d="";if(a.constructor==h)d=a.mName;else{if("string"!=typeof a)throw"MSG adding handler error!";d=a}if(d){var e="__MSG__"+d;b[e]?b[e].push(c):b[e]=[c]}},this.delHandler=function(a,c){var d="";if(a.constructor==h)d=a.mName;else{if("string"!=typeof a)throw"MSG deleting handler error!";d=a}if(d){var e="__MSG__"+d,f=0;if(b[e]&&(f=b[e].length))if(c)for(var g=0;f>g;g++)b[e][g]==c&&b[e].splice(g,0,1);else b[e]=[]}}},h=function(a){var b={};this.skipRecord=function(a,c){a&&(b[a]=!!c)},this.needSkip=function(a){var c=!1;return b.hasOwnProperty(a)&&(c=b[a]),c},this.mName=a,this.rLink=[],this.logList=[],this.interface={},this.__tailState=!1,this.mUsable=!0},i={},j={},k=new g;h.prototype.tailLog=function(a){"undefined"==typeof a&&(a=!0),a&&!this.__tailState&&a&&this.showLog(),this.__tailState=a},h.prototype.log=function(a,b){var c=f.getTime("-"),d="LOG["+(b||"normal")+"]:"+a+" At "+c+"\n";this.__tailState&&f.consoleLog(d),this.logList[this.logList.length]=d},h.prototype.showLog=function(){var a=this.logList.join("");return f.consoleLog(a),a},h.prototype.tools=f,h.prototype.build=function(){if(!this.mUsable)return void this.log('No permission for "building"!',"Error");var a,b={};switch(typeof arguments[0]){case"object":b=arguments[0],a=arguments[1],"string"==typeof arguments[2]&&(arguments[0].hasOwnProperty(arguments[2])?b[arguments[2]]=arguments[0][arguments[2]]:b={});break;case"string":b[arguments[0]]=arguments[1],a=arguments[2];break;default:return void this.log('Illegal param for "building"',"Error")}for(var c in b)if(b.hasOwnProperty(c)){if(this.hasOwnProperty(c)){if(!a){this.log('Repeat define for "'+c+'"',"Error");continue}this.log('Repeat define for "'+c+'"',"Warning")}this[c]="function"==typeof b[c]&&b.constructor!=h?function(){return"process"!=this.__tailState||this.needSkip(c)||this.log("Running:"+(this.mName||"anonymity")+"."+c,"Record"),b[c].apply(this,arguments)}:b[c],this.log('Success define for "'+c+'"',"Success")}return this},h.prototype.mSend=function(a,b){try{k.push(a,b,this),this.log("Sending data from "+this.mName||"anonymity success!","Success")}catch(c){this.log("Error sending from "+this.mName||"anonymity","Error")}},h.prototype.mMonitor=function(a,b){try{k.addHandler(b||this,a),this.log("Adding monitor in "+this.mName||"anonymity success!","Success")}catch(c){this.log("Error monitor in "+this.mName||"anonymity","Error")}},h.prototype.mUnmonitor=function(a,b){try{k.delHandler(b||this,a),this.log("Deleting monitor in "+this.mName||"anonymity success!","Success")}catch(c){this.log("Error unmonitor in "+this.mName||"anonymity","Error")}},h.prototype.interfaceDefine=function(a,b,c){if(arguments.length<2)return void this.log("Param illegal for Interface defining","Error");if(this.interface.hasOwnProperty(a)){if(!c)return void this.log('Repeat interface defining for "'+a+'"',"Error");this.log('Repeat interface defining for "'+a+'"',"Warning")}"string"==typeof b&&(b=[b]);var d=[];for(var e in b)"string"==typeof b[e]?d.push(b[e]):this.log("Illegal interface methods name for defining!","Error");return this.interface[a]=d,this.log('Success defining for interface "'+a+'"',"Success"),d},h.prototype.interfaceCheck=function(a){var b=[];if("string"==typeof a){if(!this.interface.hasOwnProperty(a))return this.log('The interface name of "'+a+'" is not exist!',"Failure"),!1;b=this.interface[a]}else{if(!f.isWhat(a,"array"))return this.log("Illegal params for interface checking!","Error"),!1;b=a}for(var c=b.length,d=[],e=0;c>e;e++)b[e]in this||d.push(b[e]);return d.length?d:!1},h.prototype.require=function(a,b){i[a]?i[a].link.push({state:"off",module:this}):(i[a]={src:b},i[a].link=[{state:"off",module:this}]),-1==f.indexOf(a,this.rLink)&&this.rLink.push(a)},b.modules={},b.define=function(a){a=f.trim(a);var c=new h(a);if(-1==a.indexOf(".")){if(a in b.modules)throw"Repeat define for "+a;b.modules[a]=c}else{for(var d=a.split("."),e=b.modules,g=0;g<d.length-1;g++)e=e[d[g]]=d[g]in e?e[d[g]]:{};e[d.pop()]=c}return c},b.create=function(a,g){a=f.trim(a);var h;if(-1==a.indexOf("."))h=b.modules[a];else{for(var k=a.split("."),l=b.modules,m=0;m<k.length&&(l=l[k[m]],"undefined"!=typeof l);m++);h=l}if(h){if(!c.executedList[a])for(var m=0,n=h.rLink.length;n>m;m++)if(!f.isDefined(h.rLink[m],b.modules))return d.autoLoad?void e.loader(i[h.rLink[m]].src,{callBack:function(){b.create(a,g)}}):(h.log("Rely lost for "+h.rLink[m],"Warning"),!1);return f.isArray(g)||(g=[g]),j[h.mName]=h[d.initFnName]&&h[d.initFnName].apply(h,g),c.executedList[a]=!0,j[h.mName]||!0}if(i[a])return d.autoLoad?void e.loader(i[a].src,{callBack:function(){b.create(a)}}):!1;throw"Invalid Input for "+a},b.destroy=function(a){a&&j[a]&&j[a][d.destroyFnName]&&(j[a][d.destroyFnName](),delete j[a],delete c.executedList[a])},b.options=function(){var a={};switch(arguments.length){case 2:a[arguments[0]]=arguments[1];break;case 1:a=arguments[0];break;default:return!1}return d=f.paramObj(d,a),!0},b.newM=function(a){return new h(a)},a.$M=b}(window);